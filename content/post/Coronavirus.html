---
title: "Coronavirus"
author: "Megha Joshi"
date: 2020-03-27
categories: ["R"]
tags: ["coronavirus", "COVID-19", "gganimate", "ggplot", "leaflet"]

---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/pymjs/pym.v1.js"></script>
<script src="/rmarkdown-libs/widgetframe-binding/widgetframe.js"></script>


<div id="libraries" class="section level1">
<h1>Libraries</h1>
<pre class="r"><code>library(tidyverse)
library(maps)
library(ggthemes)
library(jsonlite)
library(leaflet)
library(widgetframe)
library(lubridate)
library(gganimate)</code></pre>
</div>
<div id="read-in-the-data" class="section level1">
<h1>Read in the Data</h1>
<p>I downloaded the data from <a href="https://datahub.io/core/covid-19">DataHub</a>.</p>
<pre class="r"><code>json_file &lt;- &#39;https://datahub.io/core/covid-19/datapackage.json&#39;
json_data &lt;- fromJSON(paste(readLines(json_file), collapse = &quot;&quot;))

# get list of all resources:
# print(json_data$resources$name)

path_to_file &lt;- json_data$resources$path[2]
dat &lt;- read_csv(url(path_to_file))

dat &lt;- dat %&gt;%
  filter(Confirmed != 0) %&gt;%
  mutate(lab = paste0(&quot;Confirmed: &quot;, Confirmed, &quot; ,&quot;, &quot;Deaths: &quot;, Deaths))</code></pre>
</div>
<div id="coronavirus-confirmed-cases" class="section level1">
<h1>Coronavirus Confirmed Cases</h1>
<pre class="r"><code>covid_leaf &lt;- leaflet(data = dat, options = leafletOptions(minZoom = 1.5)) %&gt;% 
  addProviderTiles(providers$CartoDB.DarkMatter)  %&gt;%
  addCircleMarkers(~Long, ~Lat, radius = ~Confirmed/1000, label = ~lab, fillOpacity = .2)

frameWidget(covid_leaf)</code></pre>
<div id="htmlwidget-1" style="width:100%;height:480px;" class="widgetframe html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"url":"/post/Coronavirus_files/figure-html//widgets/widget_unnamed-chunk-3.html","options":{"xdomain":"*","allowfullscreen":false,"lazyload":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="cases-by-week" class="section level1">
<h1>Cases by Week</h1>
<div id="confirmed" class="section level2">
<h2>Confirmed</h2>
<pre class="r"><code>country_dat &lt;- dat %&gt;%
  filter(`Country/Region` %in% c(&quot;China&quot;, &quot;Italy&quot;, &quot;Korea, South&quot;, &quot;US&quot;)) %&gt;%
  rename(Country = `Country/Region`) %&gt;%
  mutate(week = cut(Date, &quot;week&quot;, start.on.monday = FALSE))

country_dat %&gt;%
  ggplot(aes(x = Confirmed, y = week)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;, fill = &quot;blue4&quot;) + 
  facet_wrap(~ Country) +
  labs(y = &quot;&quot;) + 
  theme_bw()</code></pre>
<p><img src="/post/Coronavirus_files/figure-html/unnamed-chunk-4-1.png" width="768" /></p>
</div>
<div id="deaths" class="section level2">
<h2>Deaths</h2>
<pre class="r"><code>country_dat %&gt;%
  ggplot(aes(x = Deaths, y = week)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;, fill = &quot;red4&quot;) + 
  facet_wrap(~ Country) +
  labs(y = &quot;&quot;) + 
  theme_bw()</code></pre>
<p><img src="/post/Coronavirus_files/figure-html/unnamed-chunk-5-1.png" width="768" /></p>
</div>
</div>
